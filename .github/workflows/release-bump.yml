name: Automated release workflow

permissions:
  contents: write

on:
  workflow_dispatch:
    inputs:
      release_branch:
        description: "Branch to create release from"
        required: false
        default: "main"
      increment:
        description: "Version increment type"
        required: false
        type: choice
        options:
          - patch
          - minor
          - major
        default: "patch"
      prerelease_type:
        description: "Prerelease type"
        required: false
        type: choice
        options:
          - none
          - alpha
          - beta
          - rc
        default: "none"
      release_notes:
        description: "Release notes source (auto or tag)"
        required: false
        type: choice
        options:
          - tag
          - auto
        default: "tag"
      prerelease:
        description: "Mark as prerelease (auto-detected from version if not specified)"
        required: false
        type: choice
        options:
          - auto
          - true
          - false
        default: "auto"
      draft:
        description: "Create as draft release"
        required: false
        type: boolean
        default: false
      python_version:
        description: "Python version to install"
        required: false
        type: string
        default: "3.12"
      install_groups:
        description: "Dependency groups to install"
        required: false
        type: string
        default: "dev"

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Create GitHub Release with Commitizen
        uses: Serapieum-of-alex/github-actions/actions/release/github@main
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          release-branch: ${{ github.event.inputs.release_branch }}
          increment: ${{ github.event.inputs.increment }}
          prerelease-type: ${{ github.event.inputs.prerelease_type }}
          release-notes: ${{ github.event.inputs.release_notes }}
          prerelease: ${{ github.event.inputs.prerelease }}
          draft: ${{ github.event.inputs.draft }}
          package-manager: uv
          python-version: "3.12"
          install-groups: "dev docs"
